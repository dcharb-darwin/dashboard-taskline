services:
  # Application (SQLite — no separate database service needed)
  app:
    build:
      context: .
      dockerfile: Dockerfile
    restart: unless-stopped
    ports:
      - "${APP_PORT:-3000}:3000"
    environment:
      NODE_ENV: production
      DATABASE_URL: file:./data/taskline.db
      JWT_SECRET: ${JWT_SECRET:-your-super-secret-jwt-key-change-this-in-production}
      OAUTH_SERVER_URL: ${OAUTH_SERVER_URL:-https://api.manus.im}
      VITE_OAUTH_PORTAL_URL: ${VITE_OAUTH_PORTAL_URL:-https://auth.manus.im}
      VITE_APP_ID: ${VITE_APP_ID:-rtc-project-manager}
      OWNER_OPEN_ID: ${OWNER_OPEN_ID:-admin}
      OWNER_NAME: ${OWNER_NAME:-Administrator}
      # Set to "true" to populate the database with sample templates,
      # projects, and tasks on container start. Useful for demos or
      # first-time setup. Idempotent — safe to leave enabled.
      SEED_ON_START: ${SEED_ON_START:-false}
    volumes:
      - app_data:/app/data

volumes:
  app_data:
    driver: local
